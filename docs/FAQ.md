
# ❓ Часто задаваемые вопросы (FAQ)

## Общие вопросы

### Q1: Что такое WindowsOptimizer?
**A:** WindowsOptimizer — это PowerShell-скрипт для автоматической очистки и оптимизации системы Windows 10/11. Он удаляет временные файлы, очищает корзину, запускает системные службы, проверяет целостность файлов и оптимизирует диски.

### Q2: Безопасен ли скрипт для использования?
**A:** Да, скрипт безопасен. Он использует только встроенные команды Windows и PowerShell. Однако **всегда рекомендуется**:
- Создавать точку восстановления системы перед запуском
- Закрывать все важные приложения
- Делать резервную копию важных данных

**⚠️ НЕ используйте на серверах** или в критичных производственных средах без тестирования!

### Q3: Нужны ли права администратора?
**A:** Да, скрипт **обязательно** должен запускаться с правами администратора, так как выполняет системные операции, требующие повышенных привилегий.

### Q4: Какая версия Windows поддерживается?
**A:** Скрипт поддерживает:
- ✅ Windows 10 (версия 1809 и новее)
- ✅ Windows 11 (все версии)
- ❌ Windows Server (не рекомендуется)
- ❌ Windows 7/8/8.1 (устарели, могут работать, но не тестировались)

### Q5: Сколько времени занимает выполнение?
**A:** Обычно от **3 до 7 минут**, в зависимости от:
- Объема временных файлов
- Скорости диска (SSD быстрее HDD)
- Выполнения проверки целостности системы (SFC) — самая долгая операция

### Q6: Можно ли запускать скрипт на ноутбуке?
**A:** Да, можно. Но рекомендуется:
- Подключить зарядное устройство (скрипт может занять время)
- Не прерывать выполнение
- Не переводить систему в сон во время работы

## Вопросы об ошибках и проблемах

### Q7: Почему показывает "Space Freed: -85.71 MB" (отрицательное значение)?
**A:** Это известная проблема в скрипте v1.0.0. Причины:
1. **Создание новых файлов во время работы**: Например, Windows Update или антивирус создают временные файлы
2. **Ошибка вычисления**: Скрипт считает место ДО и ПОСЛЕ, но не учитывает фоновые процессы
3. **SFC создает резервные копии**: Команда `sfc /scannow` может создавать резервные копии поврежденных файлов

**Решение:**
- Закройте все программы перед запуском
- Временно отключите антивирус (осторожно!)
- Дождитесь исправления в следующей версии скрипта

### Q8: Что делать, если скрипт зависает?
**A:** Если скрипт не реагирует более 15 минут:
1. Дождитесь завершения операции SFC (может занять 10-15 минут)
2. Проверьте диспетчер задач: `Ctrl+Shift+Esc` → ищите процесс `powershell.exe`
3. Если CPU/Disk активны — скрипт работает, подождите
4. Если активности нет — принудительно закройте PowerShell и перезапустите

### Q9: Ошибка "Отказано в доступе" (Access Denied)
**A:** Причины:
1. **Не запущено от имени администратора** — самая частая причина
2. **Файлы заблокированы другим процессом** — закройте все программы
3. **Антивирус блокирует** — добавьте скрипт в исключения

**Решение:**
```powershell
# Правильный запуск от администратора
Start-Process PowerShell -Verb RunAs -ArgumentList "-ExecutionPolicy Bypass -File C:\Tools\WindowsOptimizer.ps1"
```

### Q10: Ошибка "Не удается загрузить файл ... не подписан"
**A:** Это связано с политикой выполнения PowerShell.

**Решение:**
```powershell
# Временно разрешить выполнение
Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process -Force

# Или запустить с параметром
PowerShell.exe -ExecutionPolicy Bypass -File "C:\Tools\WindowsOptimizer.ps1"
```

### Q11: SFC не находит нарушений, но система работает нестабильно
**A:** SFC проверяет только системные файлы Windows. Для более глубокой проверки:

```powershell
# 1. Проверка образа системы
DISM /Online /Cleanup-Image /CheckHealth

# 2. Восстановление образа (если найдены проблемы)
DISM /Online /Cleanup-Image /RestoreHealth

# 3. Повторный запуск SFC
sfc /scannow
```

### Q12: Диск заполняется снова через несколько дней
**A:** Причины:
1. **Windows Update загружает обновления** — это нормально
2. **Кэш браузера** — очистите вручную
3. **Загрузки и временные файлы** — проверьте папку Downloads
4. **Журналы Windows** — могут занимать много места
5. **Вирусы/майнеры** — просканируйте систему

**Проверка:**
```powershell
# Найти самые большие папки на диске C:
Get-ChildItem -Path C:\ -Directory -Recurse -ErrorAction SilentlyContinue | 
    Get-ChildItem -File -Recurse -ErrorAction SilentlyContinue | 
    Group-Object DirectoryName | 
    Select-Object @{Name="Folder";Expression={$_.Name}}, @{Name="SizeGB";Expression={($_.Group | Measure-Object Length -Sum).Sum / 1GB}} | 
    Sort-Object SizeGB -Descending | 
    Select-Object -First 20
```

## Вопросы о функциональности

### Q13: Можно ли изменить скрипт под свои нужды?
**A:** Да, скрипт открыт и распространяется под лицензией MIT. Вы можете:
- Редактировать код в любом текстовом редакторе
- Добавлять/удалять функции
- Делать форк на GitHub и создавать свою версию

**Пример:** Отключить SFC (самую долгую операцию):
```powershell
# Откройте WindowsOptimizer.ps1 в блокноте
# Найдите строку:
# sfc /scannow

# Закомментируйте ее (добавьте # в начале):
# # sfc /scannow
```

### Q14: Можно ли запустить только часть оптимизаций?
**A:** Да, можно вручную выполнить отдельные шаги:

```powershell
# Только очистка временных файлов
Remove-Item -Path "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
Remove-Item -Path "C:\Windows\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue

# Только очистка корзины
Clear-RecycleBin -Force

# Только оптимизация диска
Optimize-Volume -DriveLetter C -Defrag
```

### Q15: Где хранятся логи выполнения?
**A:** Логи сохраняются в:
```
C:\Windows\Temp\WindowsOptimizer.log
```

Для просмотра:
```powershell
# Просмотр последних 50 строк
Get-Content "C:\Windows\Temp\WindowsOptimizer.log" -Tail 50

# Поиск ошибок
Select-String -Path "C:\Windows\Temp\WindowsOptimizer.log" -Pattern "ERROR"
```

### Q16: Удаляются ли важные файлы?
**A:** Нет. Скрипт удаляет только:
- **Временные файлы** (`%TEMP%`, `C:\Windows\Temp`)
- **Prefetch** (ускоряет следующий запуск программ, но может быть очищен)
- **Корзину** (уже удаленные файлы)

**НЕ удаляется:**
- Личные файлы (документы, фото, видео)
- Установленные программы
- Системные файлы Windows
- Файлы на других дисках (D:, E: и т.д.)

## Вопросы об автоматизации

### Q17: Можно ли настроить автоматический запуск?
**A:** Да, через планировщик задач Windows:

```powershell
# Создание задачи на еженедельный запуск (суббота, 3:00)
$action = New-ScheduledTaskAction -Execute "PowerShell.exe" `
    -Argument "-ExecutionPolicy Bypass -NoProfile -File C:\Tools\WindowsOptimizer.ps1"

$trigger = New-ScheduledTaskTrigger -Weekly -DaysOfWeek Saturday -At 3:00AM

$principal = New-ScheduledTaskPrincipal -UserId "SYSTEM" `
    -LogonType ServiceAccount -RunLevel Highest

Register-ScheduledTask -TaskName "WindowsOptimizer Auto" `
    -Action $action -Trigger $trigger -Principal $principal
```

### Q18: Как отключить автоматический запуск?
**A:**
```powershell
# Удалить задачу
Unregister-ScheduledTask -TaskName "WindowsOptimizer Auto" -Confirm:$false

# Или временно отключить
Disable-ScheduledTask -TaskName "WindowsOptimizer Auto"
```

### Q19: Можно ли запускать скрипт удаленно?
**A:** Да, через PowerShell Remoting:

```powershell
# На удаленном компьютере
Enable-PSRemoting -Force

# С локального компьютера
$session = New-PSSession -ComputerName "REMOTE-PC-NAME"
Invoke-Command -Session $session -ScriptBlock {
    & "C:\Tools\WindowsOptimizer.ps1"
}
```

**⚠️ Требует:**
- Права администратора на обоих компьютерах
- Включенный PowerShell Remoting
- Открытые порты файрвола

## Вопросы о производительности

### Q20: Как часто нужно запускать скрипт?
**A:** Зависит от интенсивности использования:

| Использование | Рекомендуемая частота |
|---------------|-----------------------|
| Легкое (офис, браузер) | Раз в 2 недели |
| Среднее (игры, мультимедиа) | Раз в неделю |
| Интенсивное (разработка, видеомонтаж) | 2-3 раза в неделю |

### Q21: Ускорит ли скрипт работу компьютера?
**A:** Да, но эффект зависит от начального состояния:
- **Большой эффект:** Если диск почти заполнен (>90%) и много временных файлов
- **Средний эффект:** При регулярном использовании (1-3 GB освобождается)
- **Малый эффект:** Если система уже оптимизирована

**Реальная польза:**
- Освобождение места на диске
- Ускорение работы SSD за счет TRIM
- Проверка целостности системных файлов
- Запуск важных служб

### Q22: Нужно ли дефрагментировать SSD?
**A:** **НЕТ!** Современные SSD не нужно дефрагментировать. Скрипт использует команду `Optimize-Volume`, которая:
- Для **HDD**: выполняет дефрагментацию
- Для **SSD**: выполняет TRIM (очистка удаленных блоков)

Windows автоматически определяет тип диска.

### Q23: Можно ли использовать на старом компьютере?
**A:** Да, но с осторожностью:
- **HDD старше 5 лет:** Дефрагментация может занять 30+ минут
- **Мало RAM (<4 GB):** Система может тормозить во время работы
- **Старый процессор:** SFC проверка будет очень долгой

**Рекомендация:** Отключите SFC для старых систем (см. Q13).

## Вопросы о безопасности

### Q24: Может ли скрипт содержать вирусы?
**A:** Нет, если скачан из официального репозитория:
- ✅ **Безопасно:** https://github.com/Serg2206/WindowsOptimizer
- ❌ **Не безопасно:** Сторонние сайты, торренты, подозрительные ссылки

**Проверка хэша файла:**
```powershell
Get-FileHash -Path "WindowsOptimizer.ps1" -Algorithm SHA256
# Сравните с хэшем на странице релиза GitHub
```

### Q25: Нужно ли отключать антивирус?
**A:** **НЕТ**, не рекомендуется. Но некоторые антивирусы могут блокировать скрипт.

**Если антивирус блокирует:**
1. Добавьте `WindowsOptimizer.ps1` в исключения антивируса
2. Убедитесь, что файл скачан из официального репозитория
3. Проверьте файл на VirusTotal: https://www.virustotal.com/

### Q26: Записывается ли какая-то информация в интернет?
**A:** **НЕТ**. Скрипт:
- Не отправляет данные в интернет
- Не собирает личную информацию
- Не устанавливает дополнительное ПО
- Работает полностью локально

## Вопросы об обновлениях

### Q27: Как узнать о новых версиях?
**A:** Следите за релизами на GitHub:
- **Страница релизов:** https://github.com/Serg2206/WindowsOptimizer/releases
- **Уведомления:** Нажмите "Watch" → "Releases only" на странице репозитория

### Q28: Как обновить скрипт?
**A:**
1. Перейдите на https://github.com/Serg2206/WindowsOptimizer/releases
2. Скачайте последнюю версию `WindowsOptimizer.ps1`
3. Замените старый файл новым

**Через Git:**
```powershell
cd C:\Tools\WindowsOptimizer
git pull origin main
```

### Q29: Будут ли исправлены ошибки в следующих версиях?
**A:** Да, планируются улучшения:
- Исправление отрицательного значения "Space Freed"
- Добавление параметров для выборочного запуска функций
- Улучшенная обработка ошибок
- Поддержка других языков интерфейса

### Q30: Как сообщить об ошибке или предложить улучшение?
**A:** Создайте Issue на GitHub:
1. Перейдите: https://github.com/Serg2206/WindowsOptimizer/issues
2. Нажмите "New Issue"
3. Опишите проблему или предложение
4. Прикрепите лог выполнения (если есть ошибка)

---

## Не нашли ответ на свой вопрос?

- 📖 [Руководство по использованию](Usage.md)
- 🛠️ [Решение проблем](Troubleshooting.md)
- 💬 [GitHub Issues](https://github.com/Serg2206/WindowsOptimizer/issues)
- 📧 Контакт автора: создайте Issue на GitHub

---

**Вернуться к:** [Главная страница Wiki](Home.md) | [Установка](Installation.md) | [Использование](Usage.md)
